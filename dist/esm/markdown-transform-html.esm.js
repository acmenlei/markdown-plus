function t(t,e=!1){let n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("**"));){e+=t.slice(0,n);let r=(t=t.slice(n+2)).indexOf("**");if(-1==r){t="**"+t;break}e+=`<strong>${t.slice(0,r)}</strong>`,t=t.slice(r+2)}return t&&(e+=t),e}(t);return n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("*"));){e+=t.slice(0,n);let r=(t=t.slice(n+1)).indexOf("*");if(-1==r){t="*"+t;break}e+=`<i>${t.slice(0,r)}</i>`,t=t.slice(r+1)}return t&&(e+=t),e}(n),n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("`"));){e+=t.slice(0,n);let r=(t=t.slice(n+1)).indexOf("`");if(-1==r){t="`"+t;break}e+=`<code class=single-code>${t.slice(0,r)}</code>`,t=t.slice(r+1)}return t&&(e+=t),e}(n),n=function(t){let e="",n=-1;for(;-1!=(n=t.indexOf("~~"));){e+=t.slice(0,n);let r=(t=t.slice(n+2)).indexOf("~~");if(-1==r){t="~~"+t;break}e+=`<del>${t.slice(0,r)}</del>`,t=t.slice(r+2)}return t&&(e+=t),e}(n),n=function(t){let e="";for(;i.test(t);){let n=t.indexOf("![");e+=t.slice(0,n);let r=(t=t.slice(n+2)).indexOf("]("),i=t.slice(0,r),s=(t=t.slice(r+2)).indexOf(")"),l=t.slice(0,s);t=t.slice(s+1),e+=`<img alt=${i} src=${l} />`}return e+t}(n),n=function(t){let e="";for(;r.test(t);){let n=t.indexOf("[");e+=t.slice(0,n);let r=(t=t.slice(n+1)).indexOf("]("),i=t.slice(0,r),s=(t=t.slice(r+2)).indexOf(")"),l=t.slice(0,s);t=t.slice(s+1),e+=`<a href=${l} target="_blank">${i}</a>`}return e+t}(n),n=function(t){return t.replace(/icon:(\w+)(\s|\b)/g,((t,e)=>`<i class='iconfont icon-${e}'></i>`))}(n),e?n:`<p>${n}</p>`}const e=/(#+)\s(.*)/g,n=/^\s*(\d+)\.\s(.+)/,r=/\[(.*)\]\((.*)\)/,i=/!\[(.*)\]\((.*)\)/;function s(e,n){let r=n?"<ol>":"<ul>";for(const n of e)r+=`<li>${t(n.content+l(n.children),!0)}</li>`;return r+=n?"</ol>":"</ul>",r}function l(t){let e="",n=0,r=t.length;if(0===r)return"";for(;n<r;){const i=[],l=[];for(;n<r&&"no_order"===t[n].type;)l.push(t[n]),n++;for(e+=s(l,!1);n<r&&"order"===t[n].type;)i.push(t[n]),n++;e+=s(i,!0)}return e.replace(/<ul><\/ul>/,"").replace(/<ol><\/ol>/,"")}function c(t){return n.test(t)}function o(t){let e=t.indexOf("- ");return 0==e||-1!=e&&!t.slice(0,e).trim()}function u(t){return-1!=t.indexOf("#")}function f(t){return t.startsWith("```")}function a(t){return/^>/.test(t.trim())}function d(t){return"---"===t.trim()}function h(t){return"|"===t.trim()[0]}function m(t){return"::: start"===t.trim()||":::start"===t.trim()}function g(t){return":::"===t.trim()}function x(t){return"::: headStart"===t.trim()||":::headStart"===t.trim()}function b(t){return"::: mainStart"===t.trim()||":::mainStart"===t.trim()}function p(t){return`<blockquote>${t.slice(1)}</blockquote>`}function O(t,e,n,r){let i="",s=t[e].slice(3).trim().toLowerCase();for(++e;e<n&&!t[e].startsWith("```");)i+=t[e]+"\n",e++;t[e]="";const l=[r.highlight?`language-${s}`:"",r.lineNumber?"line-numbers":""].join(" ");return i=`<pre><code ${l&&`class='${l}'`}>${i}</code></pre>`,{startIdx:e,result:i}}function $(t){return t.length>6?6:t.length}function v(n){return n.trim().replace(e,((e,n,r)=>`<h${$(n)}>${t(r,!0)}</h${$(n)}>`))}function I(e,n,r){let i="<table>";for(i+=function(e){let n=-1,r="<thead><tr>";for(let i=0,s=e.length;i<s;i++)"|"==e[i]&&y(e,i-1)&&y(e,i+1)&&(-1!=n&&(r+=`<th>${t(e.slice(n+1,i))}</th>`),n=i);return r+"</tr></thead>"}(e[n]),i+="<tbody >",++n;n<r&&"|"===e[n].trim()[0];n++)i+=j(e[n]);return i+="</tbody></table>",i=i.replace(/<tr><\/tr>/,""),{startIdx:n-1,result:i}}function j(e){let n=-1,r="<tr>";for(let i=0,s=e.length;i<s;i++)if("|"==e[i]&&y(e,i-1)&&y(e,i+1)){if(-1!=n){let s=e.slice(n+1,i);if("-"===s.trim()[0])continue;r+=`<td>${t(s)}</td>`}n=i}return r+"</tr>"}function y(t,e){return" "===t[e]||null==t[e]}function k(t,e,n,r){let i="<div class=head-layout>",s="";for(++e;e<n&&("::: headEnd"!==(l=t[e]).trim()&&":::headEnd"!==l.trim());)t[e].trim()&&(s+=t[e]+"\n"),e++;var l;return i+=q(s,Object.assign(Object.assign({},r),{xss:!1}))+"</div>",{result:i,startIdx:e}}function E(t,e,n,r){let i="<div class=flex-layout>",s="";for(++e;e<n&&("::: end"!==(l=t[e]).trim()&&":::end"!==l.trim());){if(m(t[e])){const{result:i,startIdx:l}=E(t,e,n,r);s+=i,e=l}else if(x(t[e])){const{result:i,startIdx:l}=k(t,e,n,r);s+=i,e=l}else g(t[e])?(i+=`<div class=flex-layout-item>${q(s,Object.assign(Object.assign({},r),{xss:!1}))}</div>`,s=""):s+=t[e].trim()?"\n"+t[e]+"\n":"";e++}var l;return i+=`<div class=flex-layout-item>${q(s,Object.assign(Object.assign({},r),{xss:!1}))}</div>`,i+="</div>",{result:i,startIdx:e}}function S(t,e,n,r){let i="<div class=main-layout>",s="";for(++e;e<n&&("::: mainEnd"!==(l=t[e]).trim()&&":::mainEnd"!==l.trim());)t[e].trim()&&(s+=t[e]+"\n"),e++;var l;return i+=q(s,Object.assign(Object.assign({},r),{xss:!1}))+"</div>",{result:i,startIdx:e}}function W(t,e,n){let r="";for(;e<n;e++)if(t[e].trim()){if(!c(t[e])&&!o(t[e]))break;r+=t[e]+"\n"}return r=function(t){const e=t.match(/(\s)*(-|\d+\.)\s(.+)/g);if(!e)return t;!function(t){/^\s+/.test(t[0])&&(t[0]=t[0].replace(/^(\s+)/g,(t=>"\n"))),t[0].startsWith("\n")||(t[0]="\n"+t[0])}(e);const n=function(t){const e=t,n=[],r=[];return e.forEach((t=>{if(""===t.trim())return;const e=t.length-t.trimLeft().length,i=t.trim();for(;r.length&&e<=r[r.length-1].indent;)r.pop();let s=null;/^-\s/.test(i)?s={type:"no_order",content:i.slice(2),children:[]}:/^(\d+\.)\s/.test(i)&&(s={type:"order",content:i.slice(RegExp.$1.length),children:[]}),s&&(r.length?r[r.length-1].item.children.push(s):n.push(s),r.push({indent:e,item:s}))})),n}(e);return l(n)}(r),{startIdx:e,result:r}}const _={lineNumber:!1,highlight:!1,xss:!0};function q(e,n){let r=n||_,i="";r=Object.assign(Object.assign({},_),r);let s=r.xss?(g=e,g.replace(/</g,"&lt;")).split("\n"):e.split("\n"),l=(null==s?void 0:s.length)||0;var g,$;for(let e=0;e<l;){if(u(s[e]))i+=v(s[e]);else if(x(s[e])){const{result:t,startIdx:n}=k(s,e,l,r);e=n,i+=t}else if(b(s[e])){const{result:t,startIdx:n}=S(s,e,l,r);e=n,i+=t}else if(m(s[e])){const{result:t,startIdx:n}=E(s,e,l,r);e=n,i+=t}else if(d(s[e]))i+=3!==($=s[e]).length?$:"---"===$?"<hr/>":$,++e;else if(h(s[e])){const{result:t,startIdx:n}=I(s,e,l);e=n,i+=t}else if(o(s[e])||c(s[e])){const{result:t,startIdx:n}=W(s,e,l);e=n-1,i+=t}else if(f(s[e])){const{result:t,startIdx:n}=O(s,e,l,r);e=n,i+=t}else a(s[e].trim())?i+=p(s[e].trim()):(s[e]=s[e].trim())&&(i+=t(s[e]));e++}return i}export{q as markdownToHTML};
